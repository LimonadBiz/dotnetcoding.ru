---
title: Исключения в ADO.NET
author: dotnetcoding
type: post
date: 2012-06-15T10:28:57+00:00
url: /coding/isklyucheniya-v-ado-net.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Ошибки случаются всегда. В .NET Framework они возбуждают исключения — сегментирование и защищенные пути вызовов, предоставляющие разработчикам более надежный способ обработки ошибок.<!--more--> Простой блок try. . .catch позволяет перехватывать предопределенные возможные ошибочные условия и выполнять соответствующие действия. Однако важно понимать, что исключения реализованы в виде классов, и если ваши блоки перехвата ожидают появления исключения базового класса до возникновения специфического унаследованного исключения, то это специфическое исключение можно и не перехватить: оно будет замаскировано базовым классом.

Например, в .NET Framework исключение Sqll&#8217;runcateException наследуется от исключения SgiTypeF.xceptJ.on. которое является потомком System. Exception. Поэтому если при написании собственного кода обработки исключений наподобие приведенного возникнет исключение SqlTruncateException. оно будет перехвачено первым блоком System.Exception, а код блока для SqlTruncateException никогда не будет выполнен.

> try
> 
> {
  
> &#8230;
  
> }
> 
> catch (Exception ex}
  
> {
  
> &#8230;
  
> }
  
> catch (SqlTypeException sqlTypeEx)
  
> {
> 
> }
  
> catch (SqlTruncateException sqlTrancat) 

Итак, для написания эффективного кода обработки исключений необходимо разобраться в различных классах исключений, входящих в состав ADO.NET, что бы правильно применять их. 

**Исключения ADO.NET переупорядочены в .NET 2.0.**

• Исключения автономного стека, наследуемые от System. Data .DataException. Различные исключения, которые могут возникнуть при работе с автономными кешами данных.
  
Большинство исключений являются потомками класса System. Data. Data-Exception, кроме EvaluateException и SyntaxErrorException. Эти два исключения унаследованы от InvalidExpress ionExcept юп. который, в свою очередь, унаследован от класса System. Data .Data Except ion.

Класс invalidExpressionException работает как универсальная ловушка для всех исключений, связанных с выражениями и DataColumn. Исключения, связанные со стеком поставщика, наследуются от класса System.Data.DataException.DbException.

Эти исключения ADO.NET могут возбуждаться библиотеками сторонних поставщиков данных и их неуправляемым кодом. Они наследуются от класса System.Runtime.interopServices.ExternalException. Поскольку класс ExternalException — общий для всей .NET Framework, ADO.NET вводит еще один уровень наследования для отделения внешних исключений, относящихся к ADO.NET, в форме Sy stom. Data . Common . DbException. И теперь любой поставщик данных может реализовать свое собственное специализированное исключение, наследуемое от DbException, наподобие SqlException и OracieException.

Исключения, связанные с SqlTypes и являющиеся потомками System • Data . SqlTypes.SqlTypeException.

Эти исключения наследуются от System. Data. SqlTypes . SqlTypeException. Из названия понятно, что все исключения, возникающие при работе с SqlTypes. являются потомками этого исключения. От SqlTypeException наследуются четыре исключения: SqlNotFiiledException, SqlAlready-FilledException.SqlTruncateException И SqlNullValueException. 

Другие исключения ADO.NET, являющиеся непосредственными потомками

System.Exception.

Эти исключения образуют группу, наследуемую непосредственно от System.Exception: DBConcurгencyExeept1 on и Operat 1onAborted-Exception. Исключение DbConcurrenc у Except ion возбуждается адаптером данных при обнаружении нарушения параллелизма. Адаптер данных отслеживает нарушение параллелизма, когда на основании выполненной команды ожидается, что будет модифицирована одиа строка, но на самом деле модифицированных строк нет. 

В .NET 2.2 Framework появилось новое исключение — OperationAborted-Exception. Это исключение означает, что операция прекращена программой. вызвавшей API. В ADO.NET оно возбуждается тогда, когда пользователь прекращает выполнение операций SqlBulkCopy в событии SqlBulkCopy. Sql Rows Сор led. Класс SqlBulkCopy — нововведение в .NET 2.0, предназначенное для эффективной пересылки больших объемов данных из базы в базу.