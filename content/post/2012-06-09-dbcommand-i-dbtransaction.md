---
title: DbCommand и DbTransaction
author: dotnetcoding
type: post
date: 2012-06-09T09:33:35+00:00
url: /coding/dbcommand-i-dbtransaction.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Объект подключения в ADO.NET Framework требует единообразия во всевозможных реализациях различных поставщиков данных: объект команды подчиняется тем же правилам. <!--more-->Объект подключения должен быть унаследован от класса System.Data.Common.DbConnectюг., аналогично, объект команды должен быть унаследован от класса System. Data.Common. DbCommand. который, в свою очередь, реализует интерфейс IDbCommand. Следовательно, класс команд для Microsoft SQL Server — SqlCommand — находящийся в пространстве имен Sqlclient, наследуется от класса DbCommand. Это унифицирует поведение объектов SqlCommand и любых других объектов команды, например, OracleCommand.

Кроме того, команде для выполнения нужно подключение. Поэтому у класса DbCommand имеется свойство Connection (Подключение). Это подключение должно иметь тип DbConnec t. i on &#8212; И поскольку класс Sqi Connection наследуется от DbConnection. a SqlCormridna — от DbCoimand. в свойстве SqlCommand. Connection можно указать объект SqlConnection.

Аналогично, если команда должна выполнить транзакцию, то у объекта DbCommand есть свойство Transaction типа DbTransaction. DbTransaction — это базовый класс, реализующий интерфейс I DbTransaction. который обеспечивает однотипную реализацию и поведение различных реализаций Transact! on у различных поставщиков данных. Следовательно, в свойстве OracleTransaction можно указать объект OracleCorrmand.

Component, который, в свою очередь, позволяет визуально редактировать объект команды в контейнере вроде Visual Studio .NET.

Команды часто пишутся в обобщенном виде. Например, если нужно, чтобы команда обновляла информацию о клиенте, то понятно, что лучше один раз написать команду и применять ее ко всем клиентам. Это можно сделать, передавая команде параметры.