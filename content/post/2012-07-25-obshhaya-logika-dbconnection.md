---
title: Общая логика DbConnection
author: dotnetcoding
type: post
date: 2012-07-24T21:04:38+00:00
url: /coding/obshhaya-logika-dbconnection.html
description:
  - 'Класс DbConnection появился лишь в ADO.NET 2.0. Он помечен как abstract, что означает, что непосредственно создавать его экземпляры нельзя. '
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Класс DbConnection появился лишь в ADO.NET 2.0. Он помечен как abstract, что означает, что непосредственно создавать его экземпляры нельзя. От этого класса необходимо наследовать классы подключений конкретных поставщиков данных. Класс DbConnection реализует интерфейс IDbConnection, поэтому явная его реализация не нужна. Вся эта общность позволяет разрабатывать приложения, до некоторой степени не знающие о точном типе источника данных, с которыми им придется работать. Хотя SQL все равно зависит от конкретной СУБД.<!--more-->

Объект подключения поставщика данных наследуется от класса DbConnecCion и получает уже готовую логику, реализованную в базовых классах. В нем можно перекрыть реализации некоторых методов, чтобы они лучше соответствовали своему предназначению (например, в объекте SqlConnection перекрыт метод

Connection. Open, хотя он создан на базе метода SqlConnection . Dispose).

**Приложения с высокими требованиями**

Рано или поздно (скорее рано) вам придется писать код ADO.NET для приложения с высокими требованиями. Это может быть web-сайт или система с высоким параллелизмом для одновременной работы многих пользователей. В более простых однопользовательских приложениях можно держать подключение открытым сколь угодно долго, и это не принесет серьезного ущерба производительности сервера; однако приложениям с высокими требованиями присущи другие проблемы, которые необходимо учесть в их архитектуре.

Раньше уже было упомянуто, что интерфейс IDbConnection реализует I Disposable. Интерфейс IDisposaole требует, чтобы в классе подключения был реализован метод Dispose, где по соглашению и выполняется вся зачистка выделенных ресурсов.

Во многих сложных приложениях с высокими требованиями в качестве источника данных используются промышленные СУБД вроде SQL Server или Oracle. Внутри объекгов подключений для конкретных поставщиков данных, таких как SqlConnection или Orac]eConnect-ion, ADO.NET взаимодействует с этими базами данных по сети. Поддержание открытого сетевого подключения и выборка по сети больших объемов данных — одна из наиболее дорогостоящих операций, которые выполняются в типичном приложении. Ведущие web-сайты электронной коммерции и приложения торговли со склада обычно одновременно работают с сотнями или даже тысячами пользователей, которым требуется работа в реальном времени с этим wcb-сайтом или серверным приложением. Скорее всего, просто невозможно разрешить каждому пользователю подключиться к базе данных и оставить это подключение открытым на все время его работы. Вот такая задача.

Различные архитектуры доступа к данным решают эту задачу, держа открытыми несколько готовых к работе физических сетевых подключений и освобождая неиспользуемые в настоящий момент физические сетевые подключения для запросов на открытие подключения к базе данных (наподобие sq] Connection). По сути, при этом небольшое количество открытых физических подключений умножается на количество объектов DbConnection с помощью механизма пула подключений (connection pooling), который создает видимость легко доступной базы данных, не задействуя большого объема ресурсов. Различные архитектуры доступа к данным могут даже увеличивать или уменьшать объем этого пула доступных открытых подключений при изменениях потребности приложения.