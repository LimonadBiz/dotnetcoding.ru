---
title: Создание строго типизированных DataSet
author: dotnetcoding
type: post
date: 2012-07-25T10:55:07+00:00
url: /coding/sozdanie-strogo-tipizirovanny-h-dataset.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Итак, вы познакомились с некоторыми наиболее распространенными возможностями из доступных в XSD, и вы узнали, как различные элементы иэ XML-схемы влияют на поведение объектов DataSet. Вы научились управлять типами данных отдельных столбцов и представлять в DataSet таблицы, столбцы, индексы и ограничения.<!--more-->

По правде говоря, без многого из того, что вы узнали об XSD и схемах DataSet, теоретически можно обойтись, но знакомство с внутренним механизмом работы ваших инструментов никогда не помешает. Большинство рассмотренных до сих пор (и до конца этой главы) примеров работают с использованием объектов DataSet и данных XML. но вся эта информация применима к объектам DataSet и DataTable в контексте реляционных баз данных. Здесь важно помннть, что откуда бы ни были взяты данные — из XML-документа, реляционной базы данных или какого-то другого источника — схемы будут иметь один и тот же формат. Не имеет значения, как был заполнен DataSet или DataTable.

Гворя коротко, строго типизированные DataSet позволяют преобразовать следующие строки кода:

> C#
> 
> reyRcw = myDataSet.Tables[&#171;Customers&#187;].Rows[0]
> 
> Console.WriteLine(myRow[&#171;FirstName&#187;])
> 
> VB.NET
> 
> myRow &#8212; myDataSet.Tab)es(&#171;Customers&#187;).Rows(0)
> 
> Console.WriteLine(myRow(&#171;FirstName”)) 

в такую короткую и понятную строку:

> C#
> 
> Console.WriteLine(CustomerDataSet.Customers[0].FirstName) ;
> 
> VB.NET
> 
> Console.WriteLine(CustomerDataset.Customers(0).FirstName)

Это возможно благодаря мощной поддержке в .NET Framework наследования и четких логичных иерархий объектов. Строго типизированные DataSet опираются на важную концепцию: новый класс создается производным от класса DataSet. Этот новый класс реализует строго типизированные свойства и методы на основе XSD-схемы, которая была использована при генерации этого класса.

При создании экземпляра этого производного класса он обеспечит наличие целочисленных свойств с логичными именами (если схема вызвана для целочисленных столбцов) и свойств с не менее логичными именами, которые представлены в виде массивов строго типизированных строк. Так что вместо работы с классами DataRows и DataTables вы можете работать с относящимися к ним концепциями {такими как CustomersRow или CustomersTable, которые могут содержать столбцы с именами FirstName или LastName), и не мучаться с какими-то ненонятными индексами и индексаторами.

В .NET имеется два {одинаково верных) подхода к созданию строго типизированных DataSet. Их можно создать визуально в конструкторе с помощью средств Visual Studio .NET. а можно воспользоваться утилитами командной строки и аргументами компилятора. Здесь будут рассмотрены оба подхода, и вы сможете выбрать тот, который больше соответствует вашим навыкам, стилю и предпочтениям.