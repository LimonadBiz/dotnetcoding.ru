---
title: Выборка данных в подключенном стиле
author: dotnetcoding
type: post
date: 2012-07-25T09:41:14+00:00
url: /coding/vy-borka-danny-h-v-podklyuchennom-stile.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Источниками данных для приложений обычно служат выделенные внешние источники; это может быть файл или серверная программа наподобие Microsoft SQL Server или Oracle, выполняющаяся на выделенном сервере с доступом через сетевое подключение.<!--more-->

В предыдущей главе было рассказано об установлении подключения к такому внешнему источнику. Даже если сами данные могут находиться во внешнем ресурсе, т.е. в источнике данных, они все равно отображаются в объектные представления понятий или типов из источника данных, а алгоритм обработки объектных представлений данных содержится в самом приложении. Следовательно, для обработки данных приложению нужно выбрать из источника данных те части данных, с которыми оно должно работать.

Как было сказано в главах 1 и 2, ADO.NET делится на две большие части: подключенную и автономную. В данной главе речь пойдет о подключенном стиле выборки данных, когда выполняется подключение к источнику данных через подключение ADO.NET, посылаются команды и выбираются результаты — оставаясь все время подключенным к базе данных или внешнему источнику данных.

Необходимость во внешнем источнике данных возникает из-за того, что приложения больше приспособлены для хранения ло1 шеи обработки данных, а не самих данных. Совсем не редкость, когда данные промышленного приложения занимают несколько гигабайтов, но обычно в каждый момент времени приложение обрабатывает лишь небольшое подмножество этих данных. Поэтому приложению нужен способ взаимодействия с источником данных для запросов данных, нужных в данный момент.

**Взаимодействие с источником данных**

После установления подключения взаимодействие с источником данных заключается в двух операциях:

1. Указание, какие данные нужны приложению.

2. Получение результатов.

Для указания, какие данные нужны приложению, необходимо послать команду или запрос на предназначенном для этого языке или в специальном формате.

ADO.NET не накладывает ограничений на язык или синтаксис, но наиболее распространенным форматом языка запросов к источнику данных является одна из разновидностей языка структурированных запросов (Structured Query Language — SQL). В Microsoft SQLServer поддерживается язык T-SQL, а в Oracle — язык PL/SQL, но оба этих языка являются текстовыми, а их синтаксис и назначение очень похожи, хотя и не совпадают.

SQL позволяет выполнять запросы к базе данных, указав критерии выборки с помощью команды SELECT, либо обрабатывать данные командами insert, UPDATE или DELETE. Если администратор базы данных предоставит вам соответствующие права доступа, вы сможете также изменять информацию о схемах данных или выполнять функции администрирования базы данных. Текстовые строки содержат то, что обобщенно называется командами баз данных. Но в данной главе мы уделим основное внимание командам SELECT, а остальные команды языка обработки данных (Data Manipulation Language — DML) наподобие INSERT, UPDATE и delete оставим до главы 9.

SQL — это мощный язык, и его команды могут выступать в различных обличьях. Команда, посылаемаи базе данных через ADO.NET, может иметь одну из следующих форм:

— Простая команда выборки

SELECT useraddress, userphone TROM users WHERE username = &#8216;Петр1&#8242;;

— Параметризованная команда для гибкого многократного использования

SELECT useraddress, userphone FROM users where usernarre = gcJscrKame;

— Выполнение хранимой процедуры

EXEC sp getUserAddressPhone (S&#8217;JserName) ;

В ADO.NET поддерживаются приведенные выше команды, которые можно выполнить с помощью класса команды ADO.NET.