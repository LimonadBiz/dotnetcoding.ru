---
title: 'Запросы к одной таблице: принцип “укажи и щелкни”'
author: dotnetcoding
type: post
date: 2012-07-25T11:13:12+00:00
url: /coding/zaprosy-k-odnoj-tablitse-printsip-ukazhi-i-shhelkni.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Теперь, имея данные, которые можно запрашивать, мы можем написать небольшой пример, демонстрирующий выборку содержимого одной таблицы в автономном стиле.<!--more--> Для этой демонстрации воспользуемся таблицей UserTable:

1. Вначале создайте проект на базе Windows-формы. Назовите его Exercise 7.1 и измените заголовок главной формы на Exercise 7.1.

2. Активируйте в Visual Studio 2005 окно Data Sources (Источники данных) для нашего проекта. Если это окно непосредственно недоступно, его можно активировать с помощью пункта меню Data^Show Data Sources (Данные^ Показать источники данных), как показано на рис. 7.3.

3. После активации окна Data Sources щелкните на находящемся вверху значке Add New Data Source (Добавить новый источник данных) (или щелкните на гиперссылке в окне, если она доступна) и

укажите новое подключение к базе данных Test локального экземпляра SQL Server 2005. Если вы хотите использовать сетевой экземпляр SQL Server или другой источник данных наподобие Oracle, потребуется другая строка подключения и, возможно, другие объекты. но общий принцип будет тем же. Выбор базы данных Test в локальном экземпляре SQL Server 2005 показан на рисунках
  
4. После появления предложения “Choose your database objects&#187; {Выберите объекты базы данных) выберите под узлом Tables строку UserTable, как показано, а затем щелкните на кнопке Finish (Завершить).
  
5. Теперь в окне Data Sources должны появиться строки testDataSet и UserTable. и таблицу UserTable уже можно указать в элементе DataGridView или в индивидуальных управляющих элементах, или даже в собственных управляющих элементах.
  
В нашем примере будет использован режим Details (Поля). В качестве упражнения попробуйте указать для UserTable элемент DataGridView, а затем перетащить таблицу в окно формы.

6. Проверьте, что для UserTable указан режим Details
  
7. Выбирайте по одному управляющие элементы, которые вы хотите видеть на форме — пусть это будут FirstName и LastName — и перетаскивайте их в окно формы приложения. Вы уаидите, что Visual Studio 2005 добавила в контейнер компонентов четыре объекта
  
8. Откомпилируйте и запустите приложение. Вы должны увидеть выходные данные
  
Но подождите-ка: вы же не написали ни строчки кода!

Ну да. не написали. За вас это сделала Visual Studio. Если активировать пункт меню Project^Show All Files (ПроектаПоказать все файлы), то можно увидеть несколько файлов, которые создала и сопровождает за вас Visual Studio. В данном примере Visual Studio добавила код в основном в файлы Forml . Designer, cs и Forml. resx. Кроме того, для хранения строки подключения добавлен файл Арр. Conf ig, поскольку вы указали это в шагах 3 и 4. А в коде, сгенерированном в файл Forml. cs. Visual Studio добавила лишь одну строку кода для заполнения DataTable.

Это приложение было разработано лишь с помощью принципа “укажи и щелкни”, но при создании приложении уровня предприятия может понадобиться передавать объекты DataTable различным классам, которые могут генерировать XSD-сообщения или бизнес-объекты, представляющие ваиш данные. Поэтому в большинстве случаев нужно иметь возможность самостоятельно писать код и заполнять объект DataTable или DataSet.