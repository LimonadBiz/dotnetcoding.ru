---
title: 'Строго типизированные DataSet: введение'
author: dotnetcoding
type: post
date: 2012-07-25T10:50:24+00:00
url: /coding/strogo-tipizirovanny-e-dataset-vvedenie.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
До сих пор мы рассмотрели, как можно использовать класс DataSet из пространства имен System. Data. Вы познакомились с коллекциями Rows и Columns, а также научились обращаться к отдельным строкам и столбцам данных из DataSet. <!--more-->Например, в типичном DataSet можно выбрать имя клиента следующим образом:

> c#
> 
> myRcw MyDataSet.Tables[&#171;Customers&#187;].Rows[0i;
> 
> Console.WriteLine(myRow[&#171;FirstName&#187;]);
> 
> VB.NET
> 
> myRow &#8212; MyDataSet.Tables(&#171;Customers&#187;).Rows(0)
> 
> Console.WriteL:ne(myRow(&#171;FirstName&#187;))

вы сможете обращаться к данным в стиле, гораздо более дружественном к программисту и читателю:

> C#
> 
> Console.WriteLine(CustomerDataset.Customers[0].FirstName);
> 
> VB.NET
> 
> Console.WriteLine(CustomerDataSet.Customers(0).FirstName)

Как видите. Второй метод гораздо понятнее, и его легче записывать. Такая функциональность стала возможной благодаря соглашению, которое в .NET Framework называется строго типизированными DataSet: это классы, наследуемые от DataSet и придающие строго типизированное поведение на основе указанной структуры XSD.

Типизированный DataSet не является встроенным в .NET Framework классом. Как вы увидите, это сгенерированный класс, являющийся непосредственным потомком класса DataSet и позволяющий уточнять свойства и методы на основе указанной XML-схемы. Этот класс также содержит другие классы для объектов DataTable и DataRow, которые усовершенствуются аналогичным обравом. В результате можно создавать схемы и классы для конкретно ваших данных, что позволяет писать более эффективный код доступа к данным. Одиако учтите, что хотя код будет выполняться быстрее, вам потребуется все больше и больше усилий на поддержание соответствия структуры строго типизированных DataSet при изменениях системы. Хорошее сравнение строго типизированных и обычных DataSet приведены в главе 14.

Итак, для работы со строго типизированными DataSet необходимо писать XSD-схемы. Вообще-то не каждая XSD-схема задает DataSet, поэтому хорошо бы конкретно разобраться, что в XML-схеме позволяет контролировать различные аспекты DataSet.

Но есть и хорошая новость: в большинстве случаев Visual Studio позволяет очень легко создавать строго типизированные DataSet: при добавлении нового объекта DataTable автоматически создается и поддерживается и соответствующая XSD-схема.

Но все-таки не помешает разобраться в том, что же в точности может содержать XSD для строго типизированного DataSet. XML-схема обеспечивает подробное определение типов данных, отношений, ключей и ограничений для описываемых ей данных. Ниже в данной главе будет приведено обсуждение соответствия друг друту схем и объектов DataSet и создания строго типизированных DataSet. Но вначале проведем краткий обзор некоторых базовых элементов XSD.