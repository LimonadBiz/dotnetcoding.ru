---
title: Работа с DataTable
author: dotnetcoding
type: post
date: 2012-11-25T11:28:50+00:00
url: /coding/rabota-s-datatable.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Объект DataTable — это находящееся в памяти представление табличных данных. Он может быть заполнен в результате объединения одной или нескольких таблиц из базы данных. Это означает, что данные в DataTabJ е логически упорядочены в соответствии с находящимися в памяти структурами данных, представляющими столбцы и строки. <!--more-->Кроме того, могут существовать различные ограничения, накладываемые на DataTable, которые облегчают поддержание целостности данных. А именно, как было сказано в главе 6, ссылочная целостность достигается использованием ограничений по внешнему ключу, а целостность данных достигается использованием уникальных ограничений.


  
Еще одним представлением табличных данных является таблица в СУРБД. Таблица базы данных позволяет найти конкретную строку с помощью оператора вроде

> Select * from products where produced = 1

Либо можно выбрать количество строк, выполнив запрос вроде

> Select * frcrr products where productpame like ’%MP%&#8217;

Кроме того, в таблице можно отсортировать результаты примерно так: 

> Select * from products where proauctname like &#8216;%MF%’ order by price 

Во многих СУБД можно даже запросить вычисляемые столбцы, например: 

> Select price н (price * tax) аь totalprtce from products

Поэтому DataTable, являясь представлением табличных данных в находящемся в памяти объекте, должен позволять выполнять поиск, выборку и сортировку данных, а также определять в наборе результатов вычисляемые столбцы.

Кроме тош, поскольку DataTable работает в приложении ASP.NET или в приложении на базе Windows-формы (возможно, в Windows-службе), он должен быть способен на немного большее, чем табличные данные в базе, т.е. таблицы базы данных. Поскольку DataTable предназначен для работы в качестве автономного кэша табличных данных (с конечной целью возможности сохранения изменений, которые выполнены в автономном режиме, назад в базу данных), объект DataTable должен также иметь возможность сохранять истории строк для проведенных в нем изменений, и в некоторых ситуациях он должен позволять запрашивать только измененные строки или строки в конкретном состоянии, указываемом в RowState (свойство объекта DataSow).

И наконец, существует множество событий для объекта DataRow, которые позволяют работать с автономными данными.