---
title: Структура класса DataAdapter
author: dotnetcoding
type: post
date: 2012-07-25T11:10:43+00:00
url: /coding/struktura-klassa-dataadapter.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
было рассказано об адаптерах данных, реализующих интерфейсы iDataAdapter и IDbDataAdapter, но не вдаваксь в подробности.<!--more--> Вообще-то не обязательно, чтобы различные адаптеры данных просто содержали реализацию методов свои интерфейсов. В конечном результате получается именно так, но при этом задействуется пара промежуточных этапов.

Иерархия классов .NET Framework содержит абстрактный или Mustlnherit класс System. Data. Common. DbDataAdapter. от которого должны наследоваться адаптеры для конкретных поставщиков данных. Интерфейс IDbDataAdapter реализуется в классе DbDataAdapter. Класс DbDataAdapter содержит базовые возможности для конструирования механизма автономного доступа к данным, который позволяет заполнять объект DataSet или DataTable и обновлять источник данных.

В свою очередь, класс DbDataAdapter наследуется от еще одного класса — System.Data.Common.DataAdapter — который реализует интерфейс IDataAdapter. показана структура двух часто используемых в ADO.NET адаптеров данных: SqlDataAdapter и OracIeDataAdapter. чтобы понять принципы взаимодействия различных классов DataAdapter и различных классов DbCommand.

Стоит отметить, что класс DataAdapter, в свою очередь, наследуется от класса System.ComponentModel. Component. Следовательно, DataAdapter, обладаксвойствами Component, может находиться в любом объекте, реализующем интерфейс IContainer. Это означает, что объекты DataAdapter можно визуально редактировать и применять во время проектирования в таких контейнерах, как IDE Visual Studio.

**Применение класса DataAdapter
  
** 
  
Теперь вы уже знакомы со структурой классов DataAdapter в ADO.NET, и мы, вместо изучения каждого метода и свойства, налагаемого реализованными в DataAdapter интерфейсами, сосредоточимся на практическом применении адаптеров данных.

Адаптеры данных можно применять как для запросов данных, так и для изменения источника данных. Но в данной главе мы в основном будем рассматривать выборку данных из источника. Когда вы хорошенько набьете руку на выборке данных, можно будет перейти к работе с ними в автономном режиме, а затем и к обновлению данных .

Для выполнения запросов к большинству распространенных источников данных нужно выполнить SQL-запрос, упрятанный в объекте DbCommand. Это уже было продемонстрировано, но вначале давайте создадим базу данных, c которой будут работать все упражнения из данной главы.

**Создание источника данных**

Упражнения из данной главы, как и осталънак часть книги, содержат работоспособные примеры, которые работают с локальным экземпляром SQL Server 2005 или базой данных для локального доступа с помощью поставщика данных OleDb. Здесь важно учесть, что между отдельными поставщиками данных имеются тонкие различия. Для поставщика данных OracleClient такие различия при необходимости будут поясняться примерами кода.

Так что для примеров из данной главы в качестве источника данных будет применяться база данных с именем Test, которую можно легко создать в локальном экземпляре SQL Server 2005. Для создания базы выполните в SQL Server Management Studio следующий сценарий:

Create Database Test Теперь нужно создать структуру простой таблицы, к которой будут выполняться запросы. Для этого можно создать три таблицы с отношением между ними типа “многие ко многим&#187;: UserTable, PerrnissionsTable и UserPermissionsTable.