---
title: Подключение к источнику данных ADO.NET
author: dotnetcoding
type: post
date: 2012-07-20T08:46:28+00:00
url: /coding/podklyuchenie-k-istochniku-danny-h.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Трудно представить приложение, у которого нет источника данных. Компьютер обычно рассматривается как машина для обработки и хранения информации, и, как правило, хранение данных для любого серьезного приложения требует наличия специального источника данных. Этот источник данных может быть обычной базой данных Microsoft Access для простого клиентского приложения с локальным хранением данных, а может быть и полномасштабной реализацией качественной коммерческой СУБД наподобие Microsoft SQL Server или Oracle для web-сайта электронной коммерции.<!--more-->

В настоящее время существует огромное множество приложений, а их требования к СУБД могут варьироваться от постоянно подключенного пользователя до многочисленных пользователей, совместно использующих подключения из общего пула.

Каким бы простым или сложным ни было приложение, для него всегда справедлив один факт: ADO.NET должна иметь возможность устанавливать подключение к источнику данных и управлять им.

На сайте мы рассмотрим различные методы подключения к базам данных имеющиеся в ADO.NET. Вы научитесь создавать, открывать и закрывать подключения. В современном мире, сильно зависящем от Internet, постоянно встречаются приложения, работают с многочисленными пользователями, которым нужно постоянное оперативное взаимодействие с системой, а подключение к базе данных является одной из наиболее дорогостоящих операций, выполняемых серверным приложением. Поэтому современные архитектуры доступа к данным содержат реализованные механизмы решения этой проблемы наподобие пула подключений. 

## Возможность подключения

Необходимость подключения к источнику данных абсолютно важна для любой архитектуры доступа к данным. ADO.NET позволяет подключиться к источнику данных с помощью подходящего объекта подключения, который входит в состав поставщика данных, соответствующего источнику данных. Поэтому поставщик данных .NET Framework для SQL Server должен содержать класс SqlConneetion, позволяющий устанавливать подключение к базам данных Microsoft SQL Server, а поставщик данных OracleClient должен содержать класс OracleConnection, позволяющий устанавливать подключение к базам данных Oracle.

Но к какому бы источнику данных пи выполнялось подключение, имеются несколько характеристик, общих для реализаций всех подключений. Понятно, что по крайней мерс должна иметься возможность установления, т.е. открытия подключения. Чтобы открыть подключение, необходимо указать, какай информация нужна для открытия подключения — например, имя сервера, идентификатор пользователя, пароль и т.д. Поскольку каждому целевому источнику данных может понадобиться особый набор информации, позволяющий ADO.NETподключиться к источнику данных, выбран гибкий механизм указания всех этих параметров через строку подключения (connection string).

Строка подключения содержит элементы с минимальной информацией, необходимой для установления подключения, в виде последовательности пар ключ-значение. Различные пары ключ-значение в строке подключения могут также определять некоторые конфигурируемые параметры, определяющие поведение подключения- Так что тнпичнаи строка подключения имеет следующий вид:

&#171;имяпараметра1-значег1иепараметра1;имяпараметра2=значеьиепараыстра2;&#8230;&#187;

Кроме возможности открывать подключения, хорошо бы иметь возможность закрывать открытые подключения. Кроме того, при любом способе взаимодействия с источником данных может понадобиться проверить, открыто ли в настоящий момент подключение к источнику данных, и доступно оно или нет. Поэтому нужно также иметь возможность получать текущее состояние подключения.

Итак, в классе, позволяющем устанавливать подключение к базе данных, нам нужны по крайней мере два метода — Open. (Открыть) и Close (Закрыть) — и свойство State (Состояние). Теперь создадим объект подключения и напишем небольшой пример, демонстрирующий простую ситуацию подключения к базе данных.