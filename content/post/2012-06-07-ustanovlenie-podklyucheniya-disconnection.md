---
title: 'Установление подключения: Disconnection'
author: dotnetcoding
type: post
date: 2012-06-07T18:45:06+00:00
url: /coding/ustanovlenie-podklyucheniya-disconnection.html
robotsmeta:
  - index,follow
categories:
  - .NET Программирование

---
Для работы с источником данных программе нужно установить подключение к нему. Поскольку доступно множество различных источников данных, информация, необходимая для подключения к конкретному источнику данных, может сильно различаться.<!--more--> К примеру, чтобы подключиться к базе Microsoft SQL Server, может понадобиться передать идентификатор и пароль пользователя, а также имя сервера и базы данных, а подключение к базе Microsoft Access потребует указания пути файла. Кроме того, каждый источник данных может поддерживать свой собственный набор операций; например. СУБД Microsoft SQL Server позволяет изменять базы данных, что вряд ли имеет смысл в Microsoft Access.

Все источники данных различаются, но в конечном счете это все-таки источники данных: следовательно, между ними есть и много общего. В любом случае (поскольку это источник данных, к которому можно подключиться, должны быть какие-то функции для открытия подключения, закрытия подключении и проверки состояния существующего подключения.

Учитывая наличие различий и общих свойств, видимо, лучше иметь отдельные реализации для объектов подключения к каждому источнику данных, но все они должны быть унаследованы от одного и того же базового класса и реализовывать один и тот же интерфейс.

Но ведь именно это и делает ADO.NET! Объект подключения наследуется от базового класса DbConnection. который в свою очередь реализует интерфейс IDbConnection. Поэтому класс SclComeet±оп, находящийся в пространстве имен System.Data.SqlClient.SqlConnec г. icn, наследуется от класса System. Data .Common .DbConnsct юг., который, в свою очередь, реализует интерфейс System. Data.iDbConnect:on. Аналогично класс OracleConnection, находящийся в пространстве имен System. Data .OracleClient .OracleConnection, также наследуется от класса DbConnection и реализует интерфейс IDbConnection.

Итак, чтобы класс считался правильным классом подключения в ADO.NET Framework, он должен быть унаследован от класса System.Data.Comrron. Disconnection. Важно знать, что этот класс реализует интерфейс IDbConnection, который, в свою очередь, реализует интерфейс IDisposabie. Понятно, что постоянно открытое подключение зря тратит ценные ресурсы, поэтому интерфейс ID: sposable требует реализации метода Dispose, где и выполняется вся зачистка, нужная для этого объекта. Аналогично, интерфейс IDbConnection устанавливает общие основы для различных классов подключений, т.е. вводит общий набор методов и свойств, которые должны быть реализованы, чтобы объект подключения был верным.

Значит, можно быть уверенным, что у объекта подключения любого поставщика данных методом подключения к источнику данных является метод Open, а не Connect или EstablishConnection. Такая однотипность позволяет также писать код. не зависящий от поставщика.

Еще один важный момент: класс DbConnection наследуется от класса System. Component Model. Component. Это означает, что любой объект подключения ADO.NET во время разработки может находиться в среде, реализующей интерфейс IContaLner, т.к. объект Component может находиться в контейнере, реализующем интерфейс iContamer. Это оказывает непосредственное влияние на вас как на программиста: объект подключения ADO.NET можно поместить в контейнер компонентов (component tray) Visual Studio .NET. Так получается легкий и удобный пользовательский интерфейс, который позволяет визуально указывать различные свойства во время проектирования.

Когда приложение способно установить подключение, следующим важным шагом является обеспечение возможности выполнения команды. Команда должна выполняться через подключение, а поскольку команда может изменять данные, то разумно ввести некоторую транзакционную семантику, связанную с объектом команды. Следовательно, лучше рассматривать команды в связи и с подключениями, и с транзакциями — и об этом пойдет речь в следующем разделе.